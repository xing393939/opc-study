### Designing Data-Intensive Application

#### 参考资料
* [我读 DDIA](https://mp.weixin.qq.com/s/prB6R3Awu252D3czbnZUkQ)

#### 第1章 可靠、可扩展与可维护的应用系统
* 设计数据系统会碰到的问题：
  * 如何确保数据的正确性和完整性？
  * 系统降级时如何提供一致的良好表现？
  * 负载增加时系统如何扩展？
  * 友好的服务API如何设计？
* 可靠性：安全的正确的执行，即使发生了某些错误也能正确运行
  * 硬件故障：硬盘崩溃、内存故障、电网停电、网线断了等等
  * 软件错误：特定输入导致的错误；CPU内存资源用尽；依赖的服务出现异常；
  * 人为失误：以最小出错的方式设计系统
* 可扩展性：垂直扩展和水平扩展
* 可维护性：三个设计原则
  * 可运维性，良好的可操作性使工作变得简单，从而关注于高附加值的任务
    * 提供系统运行时的可观测性
    * 支持自动化，与标准工具集成
    * 避免绑定特定机器，允许机器停机维护
    * 良好的文档和易于理解的操作模式
  * 简单性
    * 复杂性的表现：状态空间的膨胀；模块紧耦合；不一致的命名和术语；引入特殊框架
    * 复杂性使得维护系统变得越来越困难，预算超支和进度滞后
    * 好的设计抽象可以隐藏大量的设计细节，对外提供干净易懂的接口
  * 可演化性：目标是可以轻松的修改数据系统，使其适应不断变化的需求
  
#### 第2章 数据模型与查询语言
* 常见的三种数据模型：关系数据库、文档数据库、图数据库
* 关系数据库和文档数据库：
  * 前者可以处理多对一和多对多，后者则不太方便
  * 后者处理一对多效率高，前者则需要联接查询
* 文档数据库和图数据库
  * 前者预期数据都来着同一文档，文档与其他文档的关联很少
  * 后者则相反，预期所有的数据都可能互相关联
  * 两者的共同点：不会对存储的数据强加一个模式，使得应用程序易于应对变化的需求
  
#### 第3章 数据存储与检索
* [DDIA逐章精度小册学习【第三章】](https://juejin.cn/post/7191125304285331516)
* CSV：123456,{"name":"a"}\n42,{"name":"b"}
* Bitcask：在CSV的基础上，用内存存储hash索引：{123456:0, 42:20}；数据分段存储，老数据段压缩
* Bitcask的缺点：
  * hash索引很大，内存放不下，放硬盘性能又跟不上
  * 不支持范围查询
* SSTable：每个段的key在该段是唯一且已排序
  * 写入时先写入内存中的红黑树，达到阈值就写入磁盘
  * 内存索引记录每个段的开始key和结束key。查找某个Key时，去所有包含该Key的区间对应的文件二分查找即可。
  * 记录log用于机器崩溃后恢复内存表
* LSM-Tree：基于SSTable的优化
  * 优化SSTable的key的查找：使用布隆过滤器
  * 层级化组织SSTable：策略有大小分级和分层压缩
* B-tree：与LSM-Tree一样，它也支持高效的点查和范围查。


















